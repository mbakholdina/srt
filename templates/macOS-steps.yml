parameters:
  workingDirectory: build  # defaults for any parameters that aren't specified
  buildType: Release
  enableLogging: OFF
  enableHeavyLogging: OFF

steps:
  - script: brew update
    displayName: 'Update homebrew'

  - script: brew install openssl gnutls nettle
    displayName: 'Install OpenSSL'

  - task: CMake@1
    inputs:
      workingDirectory: ${{ parameters.workingDirectory }}
      cmakeArgs: '../ -DCMAKE_BUILD_TYPE=${{ parameters.buildType }} -DENABLE_UNITTESTS="ON" -DENABLE_LOGGING=${{ parameters.enableLogging }} -DENABLE_HEAVY_LOGGING=${{ parameters.enableHeavyLogging }} -DCMAKE_PREFIX_PATH=/usr/local/opt/openssl'
    displayName: 'Run cmake to create make files'

  - task: CMake@1
    inputs:
      workingDirectory: ${{ parameters.workingDirectory }}
      cmakeArgs: '--build ./'
    displayName: 'Run cmake to build the project'